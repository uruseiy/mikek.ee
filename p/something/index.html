<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/mikek.ee/component---src-layouts-index-js-24339f251334102f3c84.js" as="script"/><link rel="preload" href="/mikek.ee/component---src-posts-post-page-js-19a05134e9cf5ff0c602.js" as="script"/><link rel="preload" href="/mikek.ee/path---p-something-fd8ff726050c4e060194.js" as="script"/><link rel="preload" href="/mikek.ee/app-86adf29c70bd9972a608.js" as="script"/><link rel="preload" href="/mikek.ee/commons-37e7ec241aad23eaba66.js" as="script"/><style data-styled-components="hmxuSR gsRThw">
/* sc-component-id: sc-bdVaJa */
.hmxuSR{background:#524763;margin-bottom:1.45rem;overflow:hidden;position:relative;height:20vh;} .hmxuSR h1 img{height:80px;}
/* sc-component-id: sc-bwzfXH */
.gsRThw{margin:0 auto;max-width:960px;padding:1.45rem 1.0875rem;position:relative;z-index:2;}</style><title data-react-helmet="true">mikek.ee</title><meta data-react-helmet="true" name="description" content="There&#x27;s no place like home"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><style id="gatsby-inlined-css">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt","kern"}img{max-width:100%;margin:0 0 1.45rem;padding:0}h1{font-size:2.25rem}h1,h2{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{margin:0 0 1.45rem 1.45rem;padding:0;list-style-position:outside;list-style-image:none}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{padding:0;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}pre,table{margin:0 0 1.45rem}table{padding:0;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{margin:0 0 calc(1.45rem - 1px);padding:0;background:rgba(0,0,0,.2);border:none;height:1px}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:0;padding-top:.2em;padding-bottom:.2em}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="-1322560741"><!-- react-empty: 2 --><div class="sc-bdVaJa hmxuSR" data-reactid="3"><div class="sc-bwzfXH gsRThw" data-reactid="4"><h1 style="margin:0;" data-reactid="5"><a style="color:white;text-decoration:none;" href="/mikek.ee/" data-reactid="6">mikek.ee</a></h1><p data-reactid="7">there&#x27;s no place like home</p></div><div class=" gatsby-image-outer-wrapper" style="position:initial;" data-reactid="8"><div class=" gatsby-image-wrapper" style="position:absolute;overflow:hidden;left:0;top:0;width:100%;height:100%;" data-reactid="9"><div style="width:100%;padding-bottom:66.65714285714286%;" data-reactid="10"></div><img alt="" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQCAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAABfxXLhgNBf//EABsQAAICAwEAAAAAAAAAAAAAAAIDABEBEhQk/9oACAEBAAEFAnUweTWCwlCzHocUqf/EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAwEBPwGNf//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/AUf/xAAcEAACAgIDAAAAAAAAAAAAAAAAAREhAhIDMXH/2gAIAQEABj8Cy4m1LRdmukHZj6XJ/8QAGxAAAgMBAQEAAAAAAAAAAAAAAREAITFBUXH/2gAIAQEAAT8hEQFKExdrSxwYycRnQXtQiBWhctoj9U//2gAMAwEAAgADAAAAEPA//8QAFxEAAwEAAAAAAAAAAAAAAAAAAAFBcf/aAAgBAwEBPxBFTB//xAAXEQADAQAAAAAAAAAAAAAAAAAAAVFx/9oACAECAQE/EG4aP//EAB0QAQEAAgMAAwAAAAAAAAAAAAERACExQVFxkaH/2gAIAQEAAT8QqxCF2N0zymM3RgdPEwpo8bJ9GJ8gqgl4yZCqm++JjS96b/Bn/9k=" style="position:absolute;top:0;left:0;transition:opacity 0.5s;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:0.25s;" data-reactid="11"/><noscript data-reactid="12"><img width="" height="" src="/mikek.ee/static/bg-6b6971baeb8265aadc7f014edaa6ff31-4e8db.jpeg" srcset="/mikek.ee/static/bg-6b6971baeb8265aadc7f014edaa6ff31-7cc04.jpeg 310w,
/mikek.ee/static/bg-6b6971baeb8265aadc7f014edaa6ff31-69042.jpeg 620w,
/mikek.ee/static/bg-6b6971baeb8265aadc7f014edaa6ff31-4e8db.jpeg 1240w,
/mikek.ee/static/bg-6b6971baeb8265aadc7f014edaa6ff31-50ab1.jpeg 1860w,
/mikek.ee/static/bg-6b6971baeb8265aadc7f014edaa6ff31-5e51b.jpeg 2480w,
/mikek.ee/static/bg-6b6971baeb8265aadc7f014edaa6ff31-60ab8.jpeg 3720w,
/mikek.ee/static/bg-6b6971baeb8265aadc7f014edaa6ff31-c6f77.jpeg 7000w" alt="" title="" sizes="(max-width: 1240px) 100vw, 1240px" style="position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></noscript></div></div></div><div style="margin:0 auto;max-width:960px;padding:0px 1.0875rem 1.45rem;padding-top:0;" data-reactid="13"><div data-reactid="14"><span data-reactid="15">2 March 2018</span><h1 data-reactid="16">Some thing</h1><div data-reactid="17"><p>Lorem ipsum dolor amet craft beer chartreuse heirloom mumblecore. Single-origin coffee VHS health goth irony. Organic af fam asymmetrical subway tile, brunch craft beer shaman hot chicken cray plaid squid.<!-- end --> Ennui raw denim pickled, single-origin coffee poutine vaporware biodiesel messenger bag heirloom distillery. Ennui polaroid shabby chic waistcoat godard, crucifix offal hoodie narwhal thundercats subway tile marfa occupy prism. Brunch direct trade pitchfork tbh kinfolk. Stumptown everyday carry ramps kale chips mumblecore raclette, pop-up single-origin coffee humblebrag fanny pack.</p>
<div class="gatsby-highlight">
      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">/* **********************************************
     Begin prism-core.js
********************************************** */</span>

<span class="token keyword">var</span> _self <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span>
	<span class="token operator">?</span> window   <span class="token comment">// if in browser</span>
	<span class="token punctuation">:</span> <span class="token punctuation">(</span>
		<span class="token punctuation">(</span><span class="token keyword">typeof</span> WorkerGlobalScope <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> self <span class="token keyword">instanceof</span> <span class="token class-name">WorkerGlobalScope</span><span class="token punctuation">)</span>
		<span class="token operator">?</span> self <span class="token comment">// if in worker</span>
		<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>   <span class="token comment">// if in node js</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 * MIT license http://www.opensource.org/licenses/mit-license.php/
 * @author Lea Verou http://lea.verou.me
 */</span>

<span class="token keyword">var</span> Prism <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token comment">// Private helper vars</span>
<span class="token keyword">var</span> lang <span class="token operator">=</span> <span class="token regex">/\blang(?:uage)?-(\w+)\b/i</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> uniqueId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> _ <span class="token operator">=</span> _self<span class="token punctuation">.</span>Prism <span class="token operator">=</span> <span class="token punctuation">{</span>
	manual<span class="token punctuation">:</span> _self<span class="token punctuation">.</span>Prism <span class="token operator">&amp;&amp;</span> _self<span class="token punctuation">.</span>Prism<span class="token punctuation">.</span>manual<span class="token punctuation">,</span>
	disableWorkerMessageHandler<span class="token punctuation">:</span> _self<span class="token punctuation">.</span>Prism <span class="token operator">&amp;&amp;</span> _self<span class="token punctuation">.</span>Prism<span class="token punctuation">.</span>disableWorkerMessageHandler<span class="token punctuation">,</span>
	util<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		encode<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>tokens<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>tokens <span class="token keyword">instanceof</span> <span class="token class-name">Token</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Token</span><span class="token punctuation">(</span>tokens<span class="token punctuation">.</span>type<span class="token punctuation">,</span> _<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>tokens<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">,</span> tokens<span class="token punctuation">.</span>alias<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>tokens<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'Array'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> tokens<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span>encode<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> tokens<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&amp;/g</span><span class="token punctuation">,</span> <span class="token string">'&amp;amp;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt;/g</span><span class="token punctuation">,</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\u00a0/g</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>

		type<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/\[object (\w+)\]/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>

		objId<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj<span class="token punctuation">[</span><span class="token string">'__id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'__id'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token operator">++</span>uniqueId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> obj<span class="token punctuation">[</span><span class="token string">'__id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>

		<span class="token comment">// Deep clone a language definition (e.g. to extend it)</span>
		clone<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>o<span class="token punctuation">,</span> visited<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> type <span class="token operator">=</span> _<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
			visited <span class="token operator">=</span> visited <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

			<span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">case</span> <span class="token string">'Object'</span><span class="token punctuation">:</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>visited<span class="token punctuation">[</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">objId</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">return</span> visited<span class="token punctuation">[</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">objId</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">var</span> clone <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
					visited<span class="token punctuation">[</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">objId</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> clone<span class="token punctuation">;</span>

					<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							clone<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> _<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> visited<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>

					<span class="token keyword">return</span> clone<span class="token punctuation">;</span>

				<span class="token keyword">case</span> <span class="token string">'Array'</span><span class="token punctuation">:</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>visited<span class="token punctuation">[</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">objId</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">return</span> visited<span class="token punctuation">[</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">objId</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">var</span> clone <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
					visited<span class="token punctuation">[</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">objId</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> clone<span class="token punctuation">;</span>

					o<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>v<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						clone<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> _<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> visited<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

					<span class="token keyword">return</span> clone<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">return</span> o<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	languages<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		extend<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span> redef<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> lang <span class="token operator">=</span> _<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>languages<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> redef<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				lang<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> redef<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">return</span> lang<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>

		<span class="token comment">/**
		 * Insert a token before another token in a language literal
		 * As this needs to recreate the object (we cannot actually insert before keys in object literals),
		 * we cannot just provide an object, we need anobject and a key.
		 * @param inside The key (or language id) of the parent
		 * @param before The key to insert before. If not provided, the function appends instead.
		 * @param insert Object with the key/value pairs to insert
		 * @param root The object that contains `inside`. If equal to Prism.languages, it can be omitted.
		 */</span>
		insertBefore<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>inside<span class="token punctuation">,</span> before<span class="token punctuation">,</span> insert<span class="token punctuation">,</span> root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			root <span class="token operator">=</span> root <span class="token operator">||</span> _<span class="token punctuation">.</span>languages<span class="token punctuation">;</span>
			<span class="token keyword">var</span> grammar <span class="token operator">=</span> root<span class="token punctuation">[</span>inside<span class="token punctuation">]</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				insert <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> newToken <span class="token keyword">in</span> insert<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>insert<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>newToken<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						grammar<span class="token punctuation">[</span>newToken<span class="token punctuation">]</span> <span class="token operator">=</span> insert<span class="token punctuation">[</span>newToken<span class="token punctuation">]</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">return</span> grammar<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> token <span class="token keyword">in</span> grammar<span class="token punctuation">)</span> <span class="token punctuation">{</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>grammar<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span>token <span class="token operator">==</span> before<span class="token punctuation">)</span> <span class="token punctuation">{</span>

						<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> newToken <span class="token keyword">in</span> insert<span class="token punctuation">)</span> <span class="token punctuation">{</span>

							<span class="token keyword">if</span> <span class="token punctuation">(</span>insert<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>newToken<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
								ret<span class="token punctuation">[</span>newToken<span class="token punctuation">]</span> <span class="token operator">=</span> insert<span class="token punctuation">[</span>newToken<span class="token punctuation">]</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>

					ret<span class="token punctuation">[</span>token<span class="token punctuation">]</span> <span class="token operator">=</span> grammar<span class="token punctuation">[</span>token<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// Update references in other language definitions</span>
			_<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">DFS</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>languages<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> root<span class="token punctuation">[</span>inside<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> key <span class="token operator">!=</span> inside<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">return</span> root<span class="token punctuation">[</span>inside<span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>

		<span class="token comment">// Traverse a language definition with Depth First Search</span>
		DFS<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> type<span class="token punctuation">,</span> visited<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			visited <span class="token operator">=</span> visited <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					callback<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> i<span class="token punctuation">,</span> o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> type <span class="token operator">||</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'Object'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>visited<span class="token punctuation">[</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">objId</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						visited<span class="token punctuation">[</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">objId</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
						_<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">DFS</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> visited<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'Array'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>visited<span class="token punctuation">[</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">objId</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						visited<span class="token punctuation">[</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">objId</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
						_<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">DFS</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">,</span> i<span class="token punctuation">,</span> visited<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	plugins<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

	highlightAll<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token keyword">async</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		_<span class="token punctuation">.</span><span class="token function">highlightAllUnder</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	highlightAllUnder<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>container<span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> env <span class="token operator">=</span> <span class="token punctuation">{</span>
			callback<span class="token punctuation">:</span> callback<span class="token punctuation">,</span>
			selector<span class="token punctuation">:</span> <span class="token string">'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>

		_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">"before-highlightall"</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">var</span> elements <span class="token operator">=</span> env<span class="token punctuation">.</span>elements <span class="token operator">||</span> container<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> element<span class="token punctuation">;</span> element <span class="token operator">=</span> elements<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			_<span class="token punctuation">.</span><span class="token function">highlightElement</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">,</span> env<span class="token punctuation">.</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	highlightElement<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// Find language</span>
		<span class="token keyword">var</span> language<span class="token punctuation">,</span> grammar<span class="token punctuation">,</span> parent <span class="token operator">=</span> element<span class="token punctuation">;</span>

		<span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>lang<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>className<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			parent <span class="token operator">=</span> parent<span class="token punctuation">.</span>parentNode<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			language <span class="token operator">=</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span>className<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>lang<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			grammar <span class="token operator">=</span> _<span class="token punctuation">.</span>languages<span class="token punctuation">[</span>language<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// Set language on the element, if not present</span>
		element<span class="token punctuation">.</span>className <span class="token operator">=</span> element<span class="token punctuation">.</span>className<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>lang<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\s+/g</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' language-'</span> <span class="token operator">+</span> language<span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>parentNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// Set language on the parent, for styling</span>
			parent <span class="token operator">=</span> element<span class="token punctuation">.</span>parentNode<span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/pre/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				parent<span class="token punctuation">.</span>className <span class="token operator">=</span> parent<span class="token punctuation">.</span>className<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>lang<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\s+/g</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' language-'</span> <span class="token operator">+</span> language<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">var</span> code <span class="token operator">=</span> element<span class="token punctuation">.</span>textContent<span class="token punctuation">;</span>

		<span class="token keyword">var</span> env <span class="token operator">=</span> <span class="token punctuation">{</span>
			element<span class="token punctuation">:</span> element<span class="token punctuation">,</span>
			language<span class="token punctuation">:</span> language<span class="token punctuation">,</span>
			grammar<span class="token punctuation">:</span> grammar<span class="token punctuation">,</span>
			code<span class="token punctuation">:</span> code
		<span class="token punctuation">}</span><span class="token punctuation">;</span>

		_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'before-sanity-check'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>env<span class="token punctuation">.</span>code <span class="token operator">||</span> <span class="token operator">!</span>env<span class="token punctuation">.</span>grammar<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'before-highlight'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>
				env<span class="token punctuation">.</span>element<span class="token punctuation">.</span>textContent <span class="token operator">=</span> env<span class="token punctuation">.</span>code<span class="token punctuation">;</span>
				_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'after-highlight'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'complete'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'before-highlight'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token operator">&amp;&amp;</span> _self<span class="token punctuation">.</span>Worker<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>

			worker<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				env<span class="token punctuation">.</span>highlightedCode <span class="token operator">=</span> evt<span class="token punctuation">.</span>data<span class="token punctuation">;</span>

				_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'before-insert'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>

				env<span class="token punctuation">.</span>element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> env<span class="token punctuation">.</span>highlightedCode<span class="token punctuation">;</span>

				callback <span class="token operator">&amp;&amp;</span> callback<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
				_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'after-highlight'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>
				_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'complete'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">;</span>

			worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				language<span class="token punctuation">:</span> env<span class="token punctuation">.</span>language<span class="token punctuation">,</span>
				code<span class="token punctuation">:</span> env<span class="token punctuation">.</span>code<span class="token punctuation">,</span>
				immediateClose<span class="token punctuation">:</span> <span class="token boolean">true</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token punctuation">{</span>
			env<span class="token punctuation">.</span>highlightedCode <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">highlight</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>code<span class="token punctuation">,</span> env<span class="token punctuation">.</span>grammar<span class="token punctuation">,</span> env<span class="token punctuation">.</span>language<span class="token punctuation">)</span><span class="token punctuation">;</span>

			_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'before-insert'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>

			env<span class="token punctuation">.</span>element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> env<span class="token punctuation">.</span>highlightedCode<span class="token punctuation">;</span>

			callback <span class="token operator">&amp;&amp;</span> callback<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>

			_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'after-highlight'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'complete'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	highlight<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>text<span class="token punctuation">,</span> grammar<span class="token punctuation">,</span> language<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> env <span class="token operator">=</span> <span class="token punctuation">{</span>
			text<span class="token punctuation">:</span> text<span class="token punctuation">,</span>
			grammar<span class="token punctuation">:</span> grammar<span class="token punctuation">,</span>
			language<span class="token punctuation">:</span> language
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
		env<span class="token punctuation">.</span>tokens <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">tokenize</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> grammar<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'after-tokenize'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> Token<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>tokens<span class="token punctuation">)</span><span class="token punctuation">,</span> language<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	matchGrammar<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>text<span class="token punctuation">,</span> strarr<span class="token punctuation">,</span> grammar<span class="token punctuation">,</span> index<span class="token punctuation">,</span> startPos<span class="token punctuation">,</span> oneshot<span class="token punctuation">,</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> Token <span class="token operator">=</span> _<span class="token punctuation">.</span>Token<span class="token punctuation">;</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> token <span class="token keyword">in</span> grammar<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>grammar<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>grammar<span class="token punctuation">[</span>token<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">continue</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>token <span class="token operator">==</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">var</span> patterns <span class="token operator">=</span> grammar<span class="token punctuation">[</span>token<span class="token punctuation">]</span><span class="token punctuation">;</span>
			patterns <span class="token operator">=</span> <span class="token punctuation">(</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>patterns<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">"Array"</span><span class="token punctuation">)</span> <span class="token operator">?</span> patterns <span class="token punctuation">:</span> <span class="token punctuation">[</span>patterns<span class="token punctuation">]</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> patterns<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> pattern <span class="token operator">=</span> patterns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>
					inside <span class="token operator">=</span> pattern<span class="token punctuation">.</span>inside<span class="token punctuation">,</span>
					lookbehind <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>pattern<span class="token punctuation">.</span>lookbehind<span class="token punctuation">,</span>
					greedy <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>pattern<span class="token punctuation">.</span>greedy<span class="token punctuation">,</span>
					lookbehindLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
					alias <span class="token operator">=</span> pattern<span class="token punctuation">.</span>alias<span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>greedy <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>pattern<span class="token punctuation">.</span>pattern<span class="token punctuation">.</span>global<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// Without the global flag, lastIndex won't work</span>
					<span class="token keyword">var</span> flags <span class="token operator">=</span> pattern<span class="token punctuation">.</span>pattern<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/[imuy]*$/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
					pattern<span class="token punctuation">.</span>pattern <span class="token operator">=</span> <span class="token function">RegExp</span><span class="token punctuation">(</span>pattern<span class="token punctuation">.</span>pattern<span class="token punctuation">.</span>source<span class="token punctuation">,</span> flags <span class="token operator">+</span> <span class="token string">"g"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				pattern <span class="token operator">=</span> pattern<span class="token punctuation">.</span>pattern <span class="token operator">||</span> pattern<span class="token punctuation">;</span>

				<span class="token comment">// Don’t cache length as it changes during the loop</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> index<span class="token punctuation">,</span> pos <span class="token operator">=</span> startPos<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> strarr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> pos <span class="token operator">+=</span> strarr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>

					<span class="token keyword">var</span> str <span class="token operator">=</span> strarr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span>strarr<span class="token punctuation">.</span>length <span class="token operator">></span> text<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token comment">// Something went terribly wrong, ABORT, ABORT!</span>
						<span class="token keyword">return</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token keyword">instanceof</span> <span class="token class-name">Token</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">continue</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					pattern<span class="token punctuation">.</span>lastIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

					<span class="token keyword">var</span> match <span class="token operator">=</span> pattern<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">,</span>
					    delNum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

					<span class="token comment">// Greedy patterns can override/remove up to two previously matched tokens</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>match <span class="token operator">&amp;&amp;</span> greedy <span class="token operator">&amp;&amp;</span> i <span class="token operator">!=</span> strarr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						pattern<span class="token punctuation">.</span>lastIndex <span class="token operator">=</span> pos<span class="token punctuation">;</span>
						match <span class="token operator">=</span> pattern<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>match<span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>

						<span class="token keyword">var</span> <span class="token keyword">from</span> <span class="token operator">=</span> match<span class="token punctuation">.</span>index <span class="token operator">+</span> <span class="token punctuation">(</span>lookbehind <span class="token operator">?</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
						    to <span class="token operator">=</span> match<span class="token punctuation">.</span>index <span class="token operator">+</span> match<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">,</span>
						    k <span class="token operator">=</span> i<span class="token punctuation">,</span>
						    p <span class="token operator">=</span> pos<span class="token punctuation">;</span>

						<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> len <span class="token operator">=</span> strarr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> k <span class="token operator">&lt;</span> len <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;</span> to <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token operator">!</span>strarr<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>strarr<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>greedy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
							p <span class="token operator">+=</span> strarr<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
							<span class="token comment">// Move the index i to the element in strarr that is closest to from</span>
							<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">from</span> <span class="token operator">>=</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
								<span class="token operator">++</span>i<span class="token punctuation">;</span>
								pos <span class="token operator">=</span> p<span class="token punctuation">;</span>
							<span class="token punctuation">}</span>
						<span class="token punctuation">}</span>

						<span class="token comment">/*
						 * If strarr[i] is a Token, then the match starts inside another Token, which is invalid
						 * If strarr[k - 1] is greedy we are in conflict with another greedy pattern
						 */</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>strarr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Token</span> <span class="token operator">||</span> strarr<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>greedy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">continue</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>

						<span class="token comment">// Number of tokens to delete and replace with the new match</span>
						delNum <span class="token operator">=</span> k <span class="token operator">-</span> i<span class="token punctuation">;</span>
						str <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
						match<span class="token punctuation">.</span>index <span class="token operator">-=</span> pos<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>match<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>oneshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>

						<span class="token keyword">continue</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token keyword">if</span><span class="token punctuation">(</span>lookbehind<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						lookbehindLength <span class="token operator">=</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">?</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token keyword">var</span> <span class="token keyword">from</span> <span class="token operator">=</span> match<span class="token punctuation">.</span>index <span class="token operator">+</span> lookbehindLength<span class="token punctuation">,</span>
					    match <span class="token operator">=</span> match<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>lookbehindLength<span class="token punctuation">)</span><span class="token punctuation">,</span>
					    to <span class="token operator">=</span> <span class="token keyword">from</span> <span class="token operator">+</span> match<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
					    before <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
					    after <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span><span class="token punctuation">;</span>

					<span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">,</span> delNum<span class="token punctuation">]</span><span class="token punctuation">;</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span>before<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token operator">++</span>i<span class="token punctuation">;</span>
						pos <span class="token operator">+=</span> before<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
						args<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>before<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token keyword">var</span> wrapped <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Token</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> inside<span class="token operator">?</span> _<span class="token punctuation">.</span><span class="token function">tokenize</span><span class="token punctuation">(</span>match<span class="token punctuation">,</span> inside<span class="token punctuation">)</span> <span class="token punctuation">:</span> match<span class="token punctuation">,</span> alias<span class="token punctuation">,</span> match<span class="token punctuation">,</span> greedy<span class="token punctuation">)</span><span class="token punctuation">;</span>

					args<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>wrapped<span class="token punctuation">)</span><span class="token punctuation">;</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span>after<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						args<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>after<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>splice<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>strarr<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span>delNum <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span>
						_<span class="token punctuation">.</span><span class="token function">matchGrammar</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> strarr<span class="token punctuation">,</span> grammar<span class="token punctuation">,</span> i<span class="token punctuation">,</span> pos<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span>oneshot<span class="token punctuation">)</span>
						<span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	tokenize<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> grammar<span class="token punctuation">,</span> language<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> strarr <span class="token operator">=</span> <span class="token punctuation">[</span>text<span class="token punctuation">]</span><span class="token punctuation">;</span>

		<span class="token keyword">var</span> rest <span class="token operator">=</span> grammar<span class="token punctuation">.</span>rest<span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>rest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> token <span class="token keyword">in</span> rest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				grammar<span class="token punctuation">[</span>token<span class="token punctuation">]</span> <span class="token operator">=</span> rest<span class="token punctuation">[</span>token<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">delete</span> grammar<span class="token punctuation">.</span>rest<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		_<span class="token punctuation">.</span><span class="token function">matchGrammar</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> strarr<span class="token punctuation">,</span> grammar<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> strarr<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	hooks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		all<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

		add<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> hooks <span class="token operator">=</span> _<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>all<span class="token punctuation">;</span>

			hooks<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> hooks<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

			hooks<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>

		run<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> env<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> callbacks <span class="token operator">=</span> _<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>all<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>callbacks <span class="token operator">||</span> <span class="token operator">!</span>callbacks<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> callback<span class="token punctuation">;</span> callback <span class="token operator">=</span> callbacks<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">callback</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> Token <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function-variable function">Token</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> content<span class="token punctuation">,</span> alias<span class="token punctuation">,</span> matchedStr<span class="token punctuation">,</span> greedy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>alias <span class="token operator">=</span> alias<span class="token punctuation">;</span>
	<span class="token comment">// Copy of the full string this token was created from</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token punctuation">(</span>matchedStr <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token operator">|</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>greedy <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>greedy<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Token<span class="token punctuation">.</span><span class="token function-variable function">stringify</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> language<span class="token punctuation">,</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> o <span class="token operator">==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> o<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>_<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'Array'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> o<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> Token<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> language<span class="token punctuation">,</span> o<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">var</span> env <span class="token operator">=</span> <span class="token punctuation">{</span>
		type<span class="token punctuation">:</span> o<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
		content<span class="token punctuation">:</span> Token<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>content<span class="token punctuation">,</span> language<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">,</span>
		tag<span class="token punctuation">:</span> <span class="token string">'span'</span><span class="token punctuation">,</span>
		classes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'token'</span><span class="token punctuation">,</span> o<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">,</span>
		attributes<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		language<span class="token punctuation">:</span> language<span class="token punctuation">,</span>
		parent<span class="token punctuation">:</span> parent
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span>alias<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> aliases <span class="token operator">=</span> _<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>alias<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'Array'</span> <span class="token operator">?</span> o<span class="token punctuation">.</span>alias <span class="token punctuation">:</span> <span class="token punctuation">[</span>o<span class="token punctuation">.</span>alias<span class="token punctuation">]</span><span class="token punctuation">;</span>
		Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>push<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>classes<span class="token punctuation">,</span> aliases<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	_<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'wrap'</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">var</span> attributes <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>attributes<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> name <span class="token operator">+</span> <span class="token string">'="'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token string">"/g, '&amp;quot;') + '"</span>'<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token string">'&lt;'</span> <span class="token operator">+</span> env<span class="token punctuation">.</span>tag <span class="token operator">+</span> <span class="token string">' class="'</span> <span class="token operator">+</span> env<span class="token punctuation">.</span>classes<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'"'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>attributes <span class="token operator">?</span> <span class="token string">' '</span> <span class="token operator">+</span> attributes <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'>'</span> <span class="token operator">+</span> env<span class="token punctuation">.</span>content <span class="token operator">+</span> <span class="token string">'&lt;/'</span> <span class="token operator">+</span> env<span class="token punctuation">.</span>tag <span class="token operator">+</span> <span class="token string">'>'</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_self<span class="token punctuation">.</span>document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_self<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// in Node.js</span>
		<span class="token keyword">return</span> _self<span class="token punctuation">.</span>Prism<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_<span class="token punctuation">.</span>disableWorkerMessageHandler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// In worker</span>
		_self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> message <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>evt<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
				lang <span class="token operator">=</span> message<span class="token punctuation">.</span>language<span class="token punctuation">,</span>
				code <span class="token operator">=</span> message<span class="token punctuation">.</span>code<span class="token punctuation">,</span>
				immediateClose <span class="token operator">=</span> message<span class="token punctuation">.</span>immediateClose<span class="token punctuation">;</span>

			_self<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">highlight</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> _<span class="token punctuation">.</span>languages<span class="token punctuation">[</span>lang<span class="token punctuation">]</span><span class="token punctuation">,</span> lang<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>immediateClose<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				_self<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> _self<span class="token punctuation">.</span>Prism<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//Get current script and highlight</span>
<span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span>currentScript <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"script"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>script<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	_<span class="token punctuation">.</span>filename <span class="token operator">=</span> script<span class="token punctuation">.</span>src<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_<span class="token punctuation">.</span>manual <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>script<span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">'data-manual'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>readyState <span class="token operator">!==</span> <span class="token string">"loading"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>requestAnimationFrame<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>highlightAll<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
				window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>highlightAll<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token punctuation">{</span>
			document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> _<span class="token punctuation">.</span>highlightAll<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">return</span> _self<span class="token punctuation">.</span>Prism<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> module <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Prism<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// hack for components to work correctly in node.js</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> global <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	global<span class="token punctuation">.</span>Prism <span class="token operator">=</span> Prism<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">/* **********************************************
     Begin prism-markup.js
********************************************** */</span>

Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token string">'comment'</span><span class="token punctuation">:</span> <span class="token regex">/&lt;!--[\s\S]*?-->/</span><span class="token punctuation">,</span>
	<span class="token string">'prolog'</span><span class="token punctuation">:</span> <span class="token regex">/&lt;\?[\s\S]+?\?>/</span><span class="token punctuation">,</span>
	<span class="token string">'doctype'</span><span class="token punctuation">:</span> <span class="token regex">/&lt;!DOCTYPE[\s\S]+?>/i</span><span class="token punctuation">,</span>
	<span class="token string">'cdata'</span><span class="token punctuation">:</span> <span class="token regex">/&lt;!\[CDATA\[[\s\S]*?]]>/i</span><span class="token punctuation">,</span>
	<span class="token string">'tag'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
		pattern<span class="token punctuation">:</span> <span class="token regex">/&lt;\/?(?!\d)[^\s>\/=$&lt;%]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+))?)*\s*\/?>/i</span><span class="token punctuation">,</span>
		greedy<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		inside<span class="token punctuation">:</span> <span class="token punctuation">{</span>
			<span class="token string">'tag'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
				pattern<span class="token punctuation">:</span> <span class="token regex">/^&lt;\/?[^\s>\/]+/i</span><span class="token punctuation">,</span>
				inside<span class="token punctuation">:</span> <span class="token punctuation">{</span>
					<span class="token string">'punctuation'</span><span class="token punctuation">:</span> <span class="token regex">/^&lt;\/?/</span><span class="token punctuation">,</span>
					<span class="token string">'namespace'</span><span class="token punctuation">:</span> <span class="token regex">/^[^\s>\/:]+:/</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token string">'attr-value'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
				pattern<span class="token punctuation">:</span> <span class="token regex">/=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+)/i</span><span class="token punctuation">,</span>
				inside<span class="token punctuation">:</span> <span class="token punctuation">{</span>
					<span class="token string">'punctuation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
						<span class="token regex">/^=/</span><span class="token punctuation">,</span>
						<span class="token punctuation">{</span>
							pattern<span class="token punctuation">:</span> <span class="token regex">/(^|[^\\])["']/</span><span class="token punctuation">,</span>
							lookbehind<span class="token punctuation">:</span> <span class="token boolean">true</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">]</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token string">'punctuation'</span><span class="token punctuation">:</span> <span class="token regex">/\/?>/</span><span class="token punctuation">,</span>
			<span class="token string">'attr-name'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
				pattern<span class="token punctuation">:</span> <span class="token regex">/[^\s>\/]+/</span><span class="token punctuation">,</span>
				inside<span class="token punctuation">:</span> <span class="token punctuation">{</span>
					<span class="token string">'namespace'</span><span class="token punctuation">:</span> <span class="token regex">/^[^\s>\/:]+:/</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string">'entity'</span><span class="token punctuation">:</span> <span class="token regex">/&amp;#?[\da-z]{1,8};/i</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup<span class="token punctuation">[</span><span class="token string">'tag'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>inside<span class="token punctuation">[</span><span class="token string">'attr-value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>inside<span class="token punctuation">[</span><span class="token string">'entity'</span><span class="token punctuation">]</span> <span class="token operator">=</span>
	Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup<span class="token punctuation">[</span><span class="token string">'entity'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Plugin to make entity title show the real entity, idea by Roman Komarov</span>
Prism<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'wrap'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'entity'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		env<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> env<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&amp;amp;/</span><span class="token punctuation">,</span> <span class="token string">'&amp;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>xml <span class="token operator">=</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup<span class="token punctuation">;</span>
Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>html <span class="token operator">=</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup<span class="token punctuation">;</span>
Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>mathml <span class="token operator">=</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup<span class="token punctuation">;</span>
Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>svg <span class="token operator">=</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup<span class="token punctuation">;</span>


<span class="token comment">/* **********************************************
     Begin prism-css.js
********************************************** */</span>

Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>css <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token string">'comment'</span><span class="token punctuation">:</span> <span class="token regex">/\/\*[\s\S]*?\*\//</span><span class="token punctuation">,</span>
	<span class="token string">'atrule'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
		pattern<span class="token punctuation">:</span> <span class="token regex">/@[\w-]+?.*?(?:;|(?=\s*\{))/i</span><span class="token punctuation">,</span>
		inside<span class="token punctuation">:</span> <span class="token punctuation">{</span>
			<span class="token string">'rule'</span><span class="token punctuation">:</span> <span class="token regex">/@[\w-]+/</span>
			<span class="token comment">// See rest below</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string">'url'</span><span class="token punctuation">:</span> <span class="token regex">/url\((?:(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1|.*?)\)/i</span><span class="token punctuation">,</span>
	<span class="token string">'selector'</span><span class="token punctuation">:</span> <span class="token regex">/[^{}\s][^{};]*?(?=\s*\{)/</span><span class="token punctuation">,</span>
	<span class="token string">'string'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
		pattern<span class="token punctuation">:</span> <span class="token regex">/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/</span><span class="token punctuation">,</span>
		greedy<span class="token punctuation">:</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string">'property'</span><span class="token punctuation">:</span> <span class="token regex">/[-_a-z\xA0-\uFFFF][-\w\xA0-\uFFFF]*(?=\s*:)/i</span><span class="token punctuation">,</span>
	<span class="token string">'important'</span><span class="token punctuation">:</span> <span class="token regex">/\B!important\b/i</span><span class="token punctuation">,</span>
	<span class="token string">'function'</span><span class="token punctuation">:</span> <span class="token regex">/[-a-z0-9]+(?=\()/i</span><span class="token punctuation">,</span>
	<span class="token string">'punctuation'</span><span class="token punctuation">:</span> <span class="token regex">/[(){};:]/</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>css<span class="token punctuation">[</span><span class="token string">'atrule'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>inside<span class="token punctuation">.</span>rest <span class="token operator">=</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>css<span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span><span class="token string">'markup'</span><span class="token punctuation">,</span> <span class="token string">'tag'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
		<span class="token string">'style'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
			pattern<span class="token punctuation">:</span> <span class="token regex">/(&lt;style[\s\S]*?>)[\s\S]*?(?=&lt;\/style>)/i</span><span class="token punctuation">,</span>
			lookbehind<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
			inside<span class="token punctuation">:</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>css<span class="token punctuation">,</span>
			alias<span class="token punctuation">:</span> <span class="token string">'language-css'</span><span class="token punctuation">,</span>
			greedy<span class="token punctuation">:</span> <span class="token boolean">true</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span><span class="token string">'inside'</span><span class="token punctuation">,</span> <span class="token string">'attr-value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
		<span class="token string">'style-attr'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
			pattern<span class="token punctuation">:</span> <span class="token regex">/\s*style=("|')(?:\\[\s\S]|(?!\1)[^\\])*\1/i</span><span class="token punctuation">,</span>
			inside<span class="token punctuation">:</span> <span class="token punctuation">{</span>
				<span class="token string">'attr-name'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
					pattern<span class="token punctuation">:</span> <span class="token regex">/^\s*style/i</span><span class="token punctuation">,</span>
					inside<span class="token punctuation">:</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup<span class="token punctuation">.</span>tag<span class="token punctuation">.</span>inside
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token string">'punctuation'</span><span class="token punctuation">:</span> <span class="token regex">/^\s*=\s*['"]|['"]\s*$/</span><span class="token punctuation">,</span>
				<span class="token string">'attr-value'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
					pattern<span class="token punctuation">:</span> <span class="token regex">/.+/i</span><span class="token punctuation">,</span>
					inside<span class="token punctuation">:</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>css
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			alias<span class="token punctuation">:</span> <span class="token string">'language-css'</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* **********************************************
     Begin prism-clike.js
********************************************** */</span>

Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>clike <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token string">'comment'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			pattern<span class="token punctuation">:</span> <span class="token regex">/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/</span><span class="token punctuation">,</span>
			lookbehind<span class="token punctuation">:</span> <span class="token boolean">true</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			pattern<span class="token punctuation">:</span> <span class="token regex">/(^|[^\\:])\/\/.*/</span><span class="token punctuation">,</span>
			lookbehind<span class="token punctuation">:</span> <span class="token boolean">true</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token string">'string'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
		pattern<span class="token punctuation">:</span> <span class="token regex">/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/</span><span class="token punctuation">,</span>
		greedy<span class="token punctuation">:</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string">'class-name'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
		pattern<span class="token punctuation">:</span> <span class="token regex">/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[\w.\\]+/i</span><span class="token punctuation">,</span>
		lookbehind<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		inside<span class="token punctuation">:</span> <span class="token punctuation">{</span>
			punctuation<span class="token punctuation">:</span> <span class="token regex">/[.\\]/</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token string">'keyword'</span><span class="token punctuation">:</span> <span class="token regex">/\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/</span><span class="token punctuation">,</span>
	<span class="token string">'boolean'</span><span class="token punctuation">:</span> <span class="token regex">/\b(?:true|false)\b/</span><span class="token punctuation">,</span>
	<span class="token string">'function'</span><span class="token punctuation">:</span> <span class="token regex">/[a-z0-9_]+(?=\()/i</span><span class="token punctuation">,</span>
	<span class="token string">'number'</span><span class="token punctuation">:</span> <span class="token regex">/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?/i</span><span class="token punctuation">,</span>
	<span class="token string">'operator'</span><span class="token punctuation">:</span> <span class="token regex">/--?|\+\+?|!=?=?|&lt;=?|>=?|==?=?|&amp;&amp;?|\|\|?|\?|\*|\/|~|\^|%/</span><span class="token punctuation">,</span>
	<span class="token string">'punctuation'</span><span class="token punctuation">:</span> <span class="token regex">/[{}[\];(),.:]/</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">/* **********************************************
     Begin prism-javascript.js
********************************************** */</span>

Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>javascript <span class="token operator">=</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string">'clike'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
	<span class="token string">'keyword'</span><span class="token punctuation">:</span> <span class="token regex">/\b(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/</span><span class="token punctuation">,</span>
	<span class="token string">'number'</span><span class="token punctuation">:</span> <span class="token regex">/\b(?:0[xX][\dA-Fa-f]+|0[bB][01]+|0[oO][0-7]+|NaN|Infinity)\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee][+-]?\d+)?/</span><span class="token punctuation">,</span>
	<span class="token comment">// Allow for all non-ASCII characters (See http://stackoverflow.com/a/2008444)</span>
	<span class="token string">'function'</span><span class="token punctuation">:</span> <span class="token regex">/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*\()/i</span><span class="token punctuation">,</span>
	<span class="token string">'operator'</span><span class="token punctuation">:</span> <span class="token regex">/-[-=]?|\+[+=]?|!=?=?|&lt;&lt;?=?|>>?>?=?|=(?:==?|>)?|&amp;[&amp;=]?|\|[|=]?|\*\*?=?|\/=?|~|\^=?|%=?|\?|\.{3}/</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span><span class="token string">'javascript'</span><span class="token punctuation">,</span> <span class="token string">'keyword'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
	<span class="token string">'regex'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
		pattern<span class="token punctuation">:</span> <span class="token regex">/(^|[^/])\/(?!\/)(\[[^\]\r\n]+]|\\.|[^/\\\[\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/</span><span class="token punctuation">,</span>
		lookbehind<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		greedy<span class="token punctuation">:</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// This must be declared before keyword because we use "function" inside the look-forward</span>
	<span class="token string">'function-variable'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
		pattern<span class="token punctuation">:</span> <span class="token regex">/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*=\s*(?:function\b|(?:\([^()]*\)|[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*)\s*=>))/i</span><span class="token punctuation">,</span>
		alias<span class="token punctuation">:</span> <span class="token string">'function'</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span><span class="token string">'javascript'</span><span class="token punctuation">,</span> <span class="token string">'string'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
	<span class="token string">'template-string'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
		pattern<span class="token punctuation">:</span> <span class="token regex">/`(?:\\[\s\S]|[^\\`])*`/</span><span class="token punctuation">,</span>
		greedy<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		inside<span class="token punctuation">:</span> <span class="token punctuation">{</span>
			<span class="token string">'interpolation'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
				pattern<span class="token punctuation">:</span> <span class="token regex">/\$\{[^}]+\}/</span><span class="token punctuation">,</span>
				inside<span class="token punctuation">:</span> <span class="token punctuation">{</span>
					<span class="token string">'interpolation-punctuation'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
						pattern<span class="token punctuation">:</span> <span class="token regex">/^\$\{|\}$/</span><span class="token punctuation">,</span>
						alias<span class="token punctuation">:</span> <span class="token string">'punctuation'</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					rest<span class="token punctuation">:</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>javascript
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token string">'string'</span><span class="token punctuation">:</span> <span class="token regex">/[\s\S]+/</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>markup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span><span class="token string">'markup'</span><span class="token punctuation">,</span> <span class="token string">'tag'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
		<span class="token string">'script'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
			pattern<span class="token punctuation">:</span> <span class="token regex">/(&lt;script[\s\S]*?>)[\s\S]*?(?=&lt;\/script>)/i</span><span class="token punctuation">,</span>
			lookbehind<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
			inside<span class="token punctuation">:</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>javascript<span class="token punctuation">,</span>
			alias<span class="token punctuation">:</span> <span class="token string">'language-javascript'</span><span class="token punctuation">,</span>
			greedy<span class="token punctuation">:</span> <span class="token boolean">true</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>js <span class="token operator">=</span> Prism<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>javascript<span class="token punctuation">;</span>


<span class="token comment">/* **********************************************
     Begin prism-file-highlight.js
********************************************** */</span>

<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> self <span class="token operator">===</span> <span class="token string">'undefined'</span> <span class="token operator">||</span> <span class="token operator">!</span>self<span class="token punctuation">.</span>Prism <span class="token operator">||</span> <span class="token operator">!</span>self<span class="token punctuation">.</span>document <span class="token operator">||</span> <span class="token operator">!</span>document<span class="token punctuation">.</span>querySelector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	self<span class="token punctuation">.</span>Prism<span class="token punctuation">.</span><span class="token function-variable function">fileHighlight</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token keyword">var</span> Extensions <span class="token operator">=</span> <span class="token punctuation">{</span>
			<span class="token string">'js'</span><span class="token punctuation">:</span> <span class="token string">'javascript'</span><span class="token punctuation">,</span>
			<span class="token string">'py'</span><span class="token punctuation">:</span> <span class="token string">'python'</span><span class="token punctuation">,</span>
			<span class="token string">'rb'</span><span class="token punctuation">:</span> <span class="token string">'ruby'</span><span class="token punctuation">,</span>
			<span class="token string">'ps1'</span><span class="token punctuation">:</span> <span class="token string">'powershell'</span><span class="token punctuation">,</span>
			<span class="token string">'psm1'</span><span class="token punctuation">:</span> <span class="token string">'powershell'</span><span class="token punctuation">,</span>
			<span class="token string">'sh'</span><span class="token punctuation">:</span> <span class="token string">'bash'</span><span class="token punctuation">,</span>
			<span class="token string">'bat'</span><span class="token punctuation">:</span> <span class="token string">'batch'</span><span class="token punctuation">,</span>
			<span class="token string">'h'</span><span class="token punctuation">:</span> <span class="token string">'c'</span><span class="token punctuation">,</span>
			<span class="token string">'tex'</span><span class="token punctuation">:</span> <span class="token string">'latex'</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>

		Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'pre[data-src]'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>pre<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> src <span class="token operator">=</span> pre<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-src'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">var</span> language<span class="token punctuation">,</span> parent <span class="token operator">=</span> pre<span class="token punctuation">;</span>
			<span class="token keyword">var</span> lang <span class="token operator">=</span> <span class="token regex">/\blang(?:uage)?-(?!\*)(\w+)\b/i</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>lang<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>className<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				parent <span class="token operator">=</span> parent<span class="token punctuation">.</span>parentNode<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				language <span class="token operator">=</span> <span class="token punctuation">(</span>pre<span class="token punctuation">.</span>className<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>lang<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>language<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> extension <span class="token operator">=</span> <span class="token punctuation">(</span>src<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/\.(\w+)$/</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				language <span class="token operator">=</span> Extensions<span class="token punctuation">[</span>extension<span class="token punctuation">]</span> <span class="token operator">||</span> extension<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">var</span> code <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'code'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			code<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'language-'</span> <span class="token operator">+</span> language<span class="token punctuation">;</span>

			pre<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

			code<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'Loading…'</span><span class="token punctuation">;</span>

			pre<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> src<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

					<span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">400</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						code<span class="token punctuation">.</span>textContent <span class="token operator">=</span> xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span>

						Prism<span class="token punctuation">.</span><span class="token function">highlightElement</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">>=</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						code<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'✖ Error '</span> <span class="token operator">+</span> xhr<span class="token punctuation">.</span>status <span class="token operator">+</span> <span class="token string">' while fetching file: '</span> <span class="token operator">+</span> xhr<span class="token punctuation">.</span>statusText<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">else</span> <span class="token punctuation">{</span>
						code<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'✖ Error: File does not exist or is empty'</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">;</span>

			xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>Prism<span class="token punctuation">.</span>fileHighlight<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>Typewriter snackwave selvage activated charcoal, kickstarter lo-fi kitsch actually gastropub master cleanse raclette. Street art vape shabby chic sriracha keffiyeh locavore, jean shorts chia. Gentrify green juice unicorn franzen blog waistcoat. Chartreuse VHS chambray keytar four loko, pickled everyday carry distillery YOLO etsy gastropub celiac mlkshk. Tote bag beard schlitz selfies actually. Microdosing selfies gochujang, flannel fam af franzen man bun live-edge glossier cornhole. Coloring book selfies blue bottle, prism tousled butcher mixtape sriracha pickled.</p>
<p>Kombucha sartorial roof party fashion axe semiotics cornhole edison bulb XOXO actually tumblr you probably haven't heard of them waistcoat. Roof party taxidermy +1, raclette food truck artisan swag chambray tilde retro twee before they sold out. Snackwave heirloom actually locavore taiyaki. Tacos poutine keytar thundercats hashtag aesthetic hexagon.</p>
<p>Street art irony sustainable, banh mi swag bespoke +1 etsy retro mlkshk affogato food truck mumblecore. Waistcoat selfies ethical man braid edison bulb next level kombucha meditation health goth tacos 90's beard. Artisan shaman marfa slow-carb freegan semiotics polaroid pork belly pickled. Cronut street art chillwave mustache. DIY health goth microdosing normcore. Chia food truck ugh photo booth vinyl hot chicken jean shorts.</p>
<p>Quinoa fam plaid 8-bit shabby chic palo santo photo booth chicharrones salvia actually pop-up gochujang. Biodiesel shoreditch offal slow-carb. Whatever prism before they sold out, banjo raclette pop-up selvage green juice pabst wolf drinking vinegar jean shorts cardigan single-origin coffee VHS. Keffiyeh iPhone quinoa schlitz butcher, locavore listicle live-edge williamsburg art party ramps bicycle rights disrupt. Drinking vinegar trust fund 3 wolf moon dreamcatcher mlkshk venmo semiotics crucifix prism ennui brooklyn.</p>
<p>Oh. You need a little dummy text for your mockup? How quaint.</p>
<p>I bet you’re still using Bootstrap too…</p></div></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-86adf29c70bd9972a608.js","88605697669780":"component---src-posts-post-page-js-19a05134e9cf5ff0c602.js","162898551421021":"component---src-pages-404-js-4503918ea3a16cfcdb75.js","35783957827783":"component---src-pages-index-js-233d396b4da18bc58ac6.js","218538773642512":"component---src-pages-page-2-js-65f0147ecb0dc4da2a2b.js","60335399758886":"path----191dd685278a0e0e0ed1.js","171212537118937":"path---p-something-fd8ff726050c4e060194.js","75088814383714":"path---p-something-1-cd592f6a1f83fb9dcdba.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","142629428675168":"path---index-e13b7fd76e033e08db39.js","135728916539164":"path---page-2-a0e39f21c11f6a62c5ab.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-24339f251334102f3c84.js"}/*]]>*/</script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/mikek.ee/commons-37e7ec241aad23eaba66.js","/mikek.ee/app-86adf29c70bd9972a608.js","/mikek.ee/path---p-something-fd8ff726050c4e060194.js","/mikek.ee/component---src-posts-post-page-js-19a05134e9cf5ff0c602.js","/mikek.ee/component---src-layouts-index-js-24339f251334102f3c84.js"])/*]]>*/</script></body></html>